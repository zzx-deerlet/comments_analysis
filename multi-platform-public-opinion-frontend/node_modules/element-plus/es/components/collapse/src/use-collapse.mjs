import { ref, computed, provide } from 'vue';
import { collapseContextKey } from './constants.mjs';
import { castArray } from 'lodash-unified';
import { UPDATE_MODEL_EVENT, CHANGE_EVENT } from '../../../constants/event.mjs';
import { useNamespace } from '../../../hooks/use-namespace/index.mjs';

const useCollapse = (props, emit) => {
  const activeNames = ref([]);
  const computedActiveNames = computed(() => {
    var _a;
    const activeKeys = (_a = props.modelValue) != null ? _a : activeNames.value;
    return castArray(activeKeys);
  });
  const setActiveNames = (_activeNames) => {
    activeNames.value = _activeNames;
    const value = props.accordion ? activeNames.value[0] : activeNames.value;
    emit(UPDATE_MODEL_EVENT, value);
    emit(CHANGE_EVENT, value);
  };
  const handleItemClick = (name) => {
    if (props.accordion) {
      setActiveNames([computedActiveNames.value[0] === name ? "" : name]);
    } else {
      const _activeNames = [...computedActiveNames.value];
      const index = _activeNames.indexOf(name);
      if (index > -1) {
        _activeNames.splice(index, 1);
      } else {
        _activeNames.push(name);
      }
      setActiveNames(_activeNames);
    }
  };
  provide(collapseContextKey, {
    activeNames: computedActiveNames,
    handleItemClick
  });
  return {
    activeNames: computedActiveNames,
    setActiveNames
  };
};
const useCollapseDOM = (props) => {
  const ns = useNamespace("collapse");
  const rootKls = computed(() => [
    ns.b(),
    ns.b(`icon-position-${props.expandIconPosition}`)
  ]);
  return {
    rootKls
  };
};

export { useCollapse, useCollapseDOM };
//# sourceMappingURL=use-collapse.mjs.map
