{"ast":null,"code":"import { ref, reactive } from 'vue';\nimport { useStore } from 'vuex';\nimport { ElMessage } from 'element-plus';\nimport { Plus } from '@element-plus/icons-vue';\nexport default {\n  __name: 'System',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const store = useStore();\n    const systemFormRef = ref(null);\n    const dataSourceDialogVisible = ref(false);\n    const systemForm = reactive({\n      systemName: '多平台舆情分析系统',\n      logo: '',\n      refreshInterval: 5,\n      dataRetention: 30,\n      exportFormat: 'excel'\n    });\n    const dataSourceForm = reactive({\n      weiboApi: '',\n      wechatApi: '',\n      zhihuApi: '',\n      bilibiliApi: ''\n    });\n    const handleLogoSuccess = response => {\n      systemForm.logo = response.url;\n    };\n    const handleDataSourceConfig = () => {\n      dataSourceDialogVisible.value = true;\n    };\n    const handleDataSourceSave = async () => {\n      try {\n        await store.dispatch('system/updateDataSource', dataSourceForm);\n        ElMessage.success('数据源配置保存成功');\n        dataSourceDialogVisible.value = false;\n      } catch (error) {\n        ElMessage.error('数据源配置保存失败');\n      }\n    };\n    const handleSubmit = async () => {\n      try {\n        await store.dispatch('system/updateSettings', systemForm);\n        ElMessage.success('设置保存成功');\n      } catch (error) {\n        ElMessage.error('设置保存失败');\n      }\n    };\n    const handleReset = () => {\n      systemFormRef.value?.resetFields();\n    };\n    const __returned__ = {\n      store,\n      systemFormRef,\n      dataSourceDialogVisible,\n      systemForm,\n      dataSourceForm,\n      handleLogoSuccess,\n      handleDataSourceConfig,\n      handleDataSourceSave,\n      handleSubmit,\n      handleReset,\n      ref,\n      reactive,\n      get useStore() {\n        return useStore;\n      },\n      get ElMessage() {\n        return ElMessage;\n      },\n      get Plus() {\n        return Plus;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","reactive","useStore","ElMessage","Plus","store","systemFormRef","dataSourceDialogVisible","systemForm","systemName","logo","refreshInterval","dataRetention","exportFormat","dataSourceForm","weiboApi","wechatApi","zhihuApi","bilibiliApi","handleLogoSuccess","response","url","handleDataSourceConfig","value","handleDataSourceSave","dispatch","success","error","handleSubmit","handleReset","resetFields"],"sources":["D:/a课程/软件工程/OpinionAnalysis/src/views/System.vue"],"sourcesContent":["<template>\r\n  <div class=\"system-container\">\r\n    <el-card class=\"system-card\">\r\n      <template #header>\r\n        <div class=\"card-header\">\r\n          <span>系统设置</span>\r\n        </div>\r\n      </template>\r\n      \r\n      <el-form\r\n        ref=\"systemFormRef\"\r\n        :model=\"systemForm\"\r\n        label-width=\"120px\"\r\n      >\r\n        <el-form-item label=\"系统名称\">\r\n          <el-input v-model=\"systemForm.systemName\" />\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"系统Logo\">\r\n          <el-upload\r\n            class=\"logo-uploader\"\r\n            action=\"/api/system/upload\"\r\n            :show-file-list=\"false\"\r\n            :on-success=\"handleLogoSuccess\"\r\n          >\r\n            <img v-if=\"systemForm.logo\" :src=\"systemForm.logo\" class=\"logo\" />\r\n            <el-icon v-else class=\"logo-uploader-icon\"><Plus /></el-icon>\r\n          </el-upload>\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"数据刷新间隔\">\r\n          <el-input-number\r\n            v-model=\"systemForm.refreshInterval\"\r\n            :min=\"1\"\r\n            :max=\"60\"\r\n          />\r\n          <span class=\"unit\">分钟</span>\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"数据保留时间\">\r\n          <el-input-number\r\n            v-model=\"systemForm.dataRetention\"\r\n            :min=\"1\"\r\n            :max=\"365\"\r\n          />\r\n          <span class=\"unit\">天</span>\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"导出文件格式\">\r\n          <el-radio-group v-model=\"systemForm.exportFormat\">\r\n            <el-radio label=\"excel\">Excel</el-radio>\r\n            <el-radio label=\"csv\">CSV</el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"数据源配置\">\r\n          <el-button type=\"primary\" @click=\"handleDataSourceConfig\">\r\n            配置数据源\r\n          </el-button>\r\n        </el-form-item>\r\n        \r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"handleSubmit\">保存设置</el-button>\r\n          <el-button @click=\"handleReset\">重置</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-card>\r\n    \r\n    <!-- 数据源配置对话框 -->\r\n    <el-dialog\r\n      v-model=\"dataSourceDialogVisible\"\r\n      title=\"数据源配置\"\r\n      width=\"60%\"\r\n    >\r\n      <el-form :model=\"dataSourceForm\" label-width=\"100px\">\r\n        <el-form-item label=\"微博API\">\r\n          <el-input v-model=\"dataSourceForm.weiboApi\" placeholder=\"请输入微博API配置\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"微信API\">\r\n          <el-input v-model=\"dataSourceForm.wechatApi\" placeholder=\"请输入微信API配置\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"知乎API\">\r\n          <el-input v-model=\"dataSourceForm.zhihuApi\" placeholder=\"请输入知乎API配置\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"B站API\">\r\n          <el-input v-model=\"dataSourceForm.bilibiliApi\" placeholder=\"请输入B站API配置\" />\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <span class=\"dialog-footer\">\r\n          <el-button @click=\"dataSourceDialogVisible = false\">取消</el-button>\r\n          <el-button type=\"primary\" @click=\"handleDataSourceSave\">确定</el-button>\r\n        </span>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive } from 'vue'\r\nimport { useStore } from 'vuex'\r\nimport { ElMessage } from 'element-plus'\r\nimport { Plus } from '@element-plus/icons-vue'\r\n\r\nconst store = useStore()\r\nconst systemFormRef = ref(null)\r\nconst dataSourceDialogVisible = ref(false)\r\n\r\nconst systemForm = reactive({\r\n  systemName: '多平台舆情分析系统',\r\n  logo: '',\r\n  refreshInterval: 5,\r\n  dataRetention: 30,\r\n  exportFormat: 'excel'\r\n})\r\n\r\nconst dataSourceForm = reactive({\r\n  weiboApi: '',\r\n  wechatApi: '',\r\n  zhihuApi: '',\r\n  bilibiliApi: ''\r\n})\r\n\r\nconst handleLogoSuccess = (response) => {\r\n  systemForm.logo = response.url\r\n}\r\n\r\nconst handleDataSourceConfig = () => {\r\n  dataSourceDialogVisible.value = true\r\n}\r\n\r\nconst handleDataSourceSave = async () => {\r\n  try {\r\n    await store.dispatch('system/updateDataSource', dataSourceForm)\r\n    ElMessage.success('数据源配置保存成功')\r\n    dataSourceDialogVisible.value = false\r\n  } catch (error) {\r\n    ElMessage.error('数据源配置保存失败')\r\n  }\r\n}\r\n\r\nconst handleSubmit = async () => {\r\n  try {\r\n    await store.dispatch('system/updateSettings', systemForm)\r\n    ElMessage.success('设置保存成功')\r\n  } catch (error) {\r\n    ElMessage.error('设置保存失败')\r\n  }\r\n}\r\n\r\nconst handleReset = () => {\r\n  systemFormRef.value?.resetFields()\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.system-container {\r\n  padding: 20px;\r\n  \r\n  .system-card {\r\n    max-width: 800px;\r\n    margin: 0 auto;\r\n  }\r\n  \r\n  .unit {\r\n    margin-left: 10px;\r\n    color: #909399;\r\n  }\r\n  \r\n  .logo-uploader {\r\n    :deep(.el-upload) {\r\n      border: 1px dashed #d9d9d9;\r\n      border-radius: 6px;\r\n      cursor: pointer;\r\n      position: relative;\r\n      overflow: hidden;\r\n      transition: var(--el-transition-duration-fast);\r\n      \r\n      &:hover {\r\n        border-color: var(--el-color-primary);\r\n      }\r\n    }\r\n    \r\n    .logo-uploader-icon {\r\n      font-size: 28px;\r\n      color: #8c939d;\r\n      width: 100px;\r\n      height: 100px;\r\n      text-align: center;\r\n      line-height: 100px;\r\n    }\r\n    \r\n    .logo {\r\n      width: 100px;\r\n      height: 100px;\r\n      display: block;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"],"mappings":"AAmGA,SAASA,GAAG,EAAEC,QAAQ,QAAQ,KAAK;AACnC,SAASC,QAAQ,QAAQ,MAAM;AAC/B,SAASC,SAAS,QAAQ,cAAc;AACxC,SAASC,IAAI,QAAQ,yBAAyB;;;;;;;IAE9C,MAAMC,KAAK,GAAGH,QAAQ,CAAC,CAAC;IACxB,MAAMI,aAAa,GAAGN,GAAG,CAAC,IAAI,CAAC;IAC/B,MAAMO,uBAAuB,GAAGP,GAAG,CAAC,KAAK,CAAC;IAE1C,MAAMQ,UAAU,GAAGP,QAAQ,CAAC;MAC1BQ,UAAU,EAAE,WAAW;MACvBC,IAAI,EAAE,EAAE;MACRC,eAAe,EAAE,CAAC;MAClBC,aAAa,EAAE,EAAE;MACjBC,YAAY,EAAE;IAChB,CAAC,CAAC;IAEF,MAAMC,cAAc,GAAGb,QAAQ,CAAC;MAC9Bc,QAAQ,EAAE,EAAE;MACZC,SAAS,EAAE,EAAE;MACbC,QAAQ,EAAE,EAAE;MACZC,WAAW,EAAE;IACf,CAAC,CAAC;IAEF,MAAMC,iBAAiB,GAAIC,QAAQ,IAAK;MACtCZ,UAAU,CAACE,IAAI,GAAGU,QAAQ,CAACC,GAAG;IAChC,CAAC;IAED,MAAMC,sBAAsB,GAAGA,CAAA,KAAM;MACnCf,uBAAuB,CAACgB,KAAK,GAAG,IAAI;IACtC,CAAC;IAED,MAAMC,oBAAoB,GAAG,MAAAA,CAAA,KAAY;MACvC,IAAI;QACF,MAAMnB,KAAK,CAACoB,QAAQ,CAAC,yBAAyB,EAAEX,cAAc,CAAC;QAC/DX,SAAS,CAACuB,OAAO,CAAC,WAAW,CAAC;QAC9BnB,uBAAuB,CAACgB,KAAK,GAAG,KAAK;MACvC,CAAC,CAAC,OAAOI,KAAK,EAAE;QACdxB,SAAS,CAACwB,KAAK,CAAC,WAAW,CAAC;MAC9B;IACF,CAAC;IAED,MAAMC,YAAY,GAAG,MAAAA,CAAA,KAAY;MAC/B,IAAI;QACF,MAAMvB,KAAK,CAACoB,QAAQ,CAAC,uBAAuB,EAAEjB,UAAU,CAAC;QACzDL,SAAS,CAACuB,OAAO,CAAC,QAAQ,CAAC;MAC7B,CAAC,CAAC,OAAOC,KAAK,EAAE;QACdxB,SAAS,CAACwB,KAAK,CAAC,QAAQ,CAAC;MAC3B;IACF,CAAC;IAED,MAAME,WAAW,GAAGA,CAAA,KAAM;MACxBvB,aAAa,CAACiB,KAAK,EAAEO,WAAW,CAAC,CAAC;IACpC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}